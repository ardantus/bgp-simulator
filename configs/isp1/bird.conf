# ISP1 Configuration (AS65001)
# Simulates upstream provider 1

log syslog all;
debug protocols all;

router id 10.1.1.1;

# Device protocol
protocol device {
    scan time 10;
}

# Direct protocol
protocol direct {
    ipv4;
    ipv6;
}

# Kernel protocol
protocol kernel {
    ipv4 {
        export all;
        import all;
    };
    learn;
    persist;
}

protocol kernel {
    ipv6 {
        export all;
        import all;
    };
    learn;
    persist;
}

# Static routes - simulating ISP1's networks
protocol static {
    ipv4;
    # ISP1 announces some public IP ranges (using private IPs for simulation)
    # The following static blackhole routes are kept for simulation but disabled by commenting.
    # Uncomment to simulate upstream blackholing of these prefixes.
    # route 8.8.8.0/24 blackhole;
    # route 1.1.1.0/24 blackhole;
    # route 203.0.113.0/24 blackhole;
}

# BGP protocol for customer (AS65000)
protocol bgp customer {
    description "BGP to Customer (AS65000)";
    local as 65001;
    neighbor 10.1.1.2 as 65000;
    
    ipv4 {
        # Accept customer routes
        import filter {
            # Accept only customer networks
            if net ~ [192.168.0.0/16{16,24}] then accept;
            reject;
        };
        
        # Export ISP1 routes
        export where source = RTS_STATIC;
        next hop self;
    };
    
    # BGP parameters
    hold time 90;
    keepalive time 30;
    
    enable extended messages;
}
